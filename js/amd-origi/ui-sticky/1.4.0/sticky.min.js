define("sticky",["require","exports","module","jquery"],function(e,t,n){function h(e){this.options=e||{},this.elem=r(this.options.element),this.callback=e.callback||function(){},this.position=e.position,this._stickyId=o++}function p(e,t,n){return r.isPlainObject(t)||(t={top:t}),t.top===undefined&&t.bottom===undefined&&(t.top=0),(new h({element:e,position:t,callback:n})).render()}function d(){return!f}function v(){if(a)return!1;var e=i[0].body;if(i[0].createElement&&e&&e.appendChild&&e.removeChild){var t,n=i[0].createElement("div"),r=function(e){return window.getComputedStyle?window.getComputedStyle(n).getPropertyValue(e):n.currentStyle.getAttribute(e)};e.appendChild(n);for(var o=0;o<s.length;o++){n.style.cssText="position:"+s[o]+"sticky;visibility:hidden;";if(t=r("position").indexOf("sticky")!==-1)break}return n.parentNode.removeChild(n),t}}function m(){return(Date.now||function(){return(new Date).getTime()})()}function g(e,t,n){var r,i,s,o,u;return function(){s=this,i=arguments,o=m();var a=function(){var f=m()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i)))},f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i)),u}}var r=e("jquery"),i=r(document),s=["-webkit-","-ms-","-o-","-moz-",""],o=0,u=(window.navigator.userAgent||"").toLowerCase(),a=u.indexOf("msie")!==-1,f=u.indexOf("msie 6")!==-1,l=v(),c=d();h.prototype._prepare=function(){var e=this.elem.offset();this._originTop=e.top,this._originLeft=e.left,this.position.top===Number.MAX_VALUE&&(this._callFix=!0,this.position.top=this._originTop),this._originStyles={position:null,top:null,bottom:null,left:null};for(var t in this._originStyles)this._originStyles.hasOwnProperty(t)&&(this._originStyles[t]=this.elem.css(t))},h.prototype.render=function(){var e=this;if(!this.elem.length||this.elem.data("bind-sticked"))return this;this._prepare(),this.adjust=function(){e._restore();var n=e.elem.offset();e._originTop=n.top,e._originLeft=n.left,t.call(e)};var t;if(p.isPositionStickySupported&&!this._callFix){t=this._supportSticky;var n="";for(var i=0;i<s.length;i++)n+="position:"+s[i]+"sticky;";this.position.top!==undefined&&(n+="top: "+this.position.top+"px;"),this.position.bottom!==undefined&&(n+="bottom: "+this.position.bottom+"px;"),this.elem[0].style.cssText+=n,this.adjust=function(){t.call(e)}}else p.isPositionFixedSupported?t=this._supportFixed:(t=this._supportAbsolute,r("<style type='text/css'> * html{ background:url(null) no-repeat fixed; } </style>").appendTo("head"));return t.call(this),r(window).on("scroll.sticky"+this._stickyId,function(){if(!e.elem.is(":visible"))return;t.call(e)}),r(window).on("resize.sticky"+this._stickyId,g(function(){e.adjust()},120)),this.elem.data("bind-sticked",!0),this},h.prototype._getTopBottom=function(e,t){var n,i;return this.position.top!==undefined&&(n=t-e<=this.position.top),this.position.bottom!==undefined&&(i=e+r(window).height()-t-this.elem.outerHeight()<=this.position.bottom),{top:n,bottom:i}},h.prototype._supportFixed=function(){var e=this.elem.data("sticked"),t=this._getTopBottom(i.scrollTop(),this._originTop);!e&&(t.top!==undefined&&t.top||t.bottom!==undefined&&t.bottom)?(this._addPlaceholder(),this.elem.css(r.extend({position:"fixed",left:this._originLeft},t.top?{top:this.position.top}:{bottom:this.position.bottom})),this.elem.data("sticked",!0),this.callback.call(this,!0)):e&&!t.top&&!t.bottom&&this._restore()},h.prototype._supportAbsolute=function(){var e=i.scrollTop(),t=this.elem.data("sticked"),n=this._getTopBottom(e,this.elem.offset().top);n.top||n.bottom||this._callFix?(t||(this._addPlaceholder(),this.elem.data("sticked",!0),this.callback.call(this,!0)),this.elem.css({position:"absolute",top:this._callFix?this._originTop+e:n.top?this.position.top+e:e+r(window).height()-this.position.bottom-this.elem.outerHeight()})):t&&!n.top&&!n.bottom&&this._restore()},h.prototype._supportSticky=function(){var e=this.elem.data("sticked"),t=this._getTopBottom(i.scrollTop(),this.elem.offset().top);!e&&(t.top!==undefined&&t.top||t.bottom!==undefined&&t.bottom)?(this.elem.data("sticked",!0),this.callback.call(this,!0)):e&&!t.top&&!t.bottom&&(this.elem.data("sticked",!1),this.callback.call(this,!1))},h.prototype._restore=function(){this._removePlaceholder(),this.elem.css(this._originStyles),this.elem.data("sticked",!1),this.callback.call(this,!1)},h.prototype._addPlaceholder=function(){var e=!1,t=this.elem.css("position");if(t==="static"||t==="relative")e=!0;this.elem.css("display")!=="block"&&(e=!1),e&&(this._placeholder=r('<div style="visibility:hidden;margin:0;padding:0;"></div>'),this._placeholder.width(this.elem.outerWidth(!0)).height(this.elem.outerHeight(!0)).css("float",this.elem.css("float")).insertAfter(this.elem))},h.prototype._removePlaceholder=function(){this._placeholder&&this._placeholder.remove()},h.prototype.destroy=function(){this._restore(),this.elem.data("bind-sticked",!1),r(window).off("scroll.sticky"+this._stickyId),r(window).off("resize.sticky"+this._stickyId)},n.exports=p,p.stick=p,p.fix=function(e){return(new h({element:e,position:{top:Number.MAX_VALUE}})).render()},p.isPositionStickySupported=l,p.isPositionFixedSupported=c});